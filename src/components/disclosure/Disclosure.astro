---
import { Icon } from "astro-icon/components";
import Tag from "../tag/Tag.astro";

const { className, company, date, open = false, tag, title } = Astro.props;
---

<details class="disclosure group" open={open}>
  <summary class="summary">
    <div
      class="summary-inner flex flex-grow justify-between items-center gap-4 min-w-0"
    >
      <div class="flex gap-4 items-center">
        <div class="flex flex-col">
          <h3 class="font-normal text-2xl">{title}</h3>
          {
            company && (
              <h4 class="text-[rgb(var(--primary-color))]">@ {company}</h4>
            )
          }
        </div>
        {tag && <Tag className="text-xs flex-shrink-0">{tag}</Tag>}
      </div>
      {date && <p class="font-light flex-shrink-0">{date}</p>}
    </div>
    <Icon name="chevron-down" size={20} class="chevron-down-icon" aria-hidden />
    <Icon name="chevron-up" size={20} class="chevron-up-icon" aria-hidden />
  </summary>
  <div class={`${className || ""} content`}>
    <slot />
  </div>
</details>

<style>
  .chevron-down-icon,
  .chevron-up-icon {
    flex-shrink: 0;
  }

  .chevron-up-icon {
    display: none;
  }

  .content {
    background-color: rgba(var(--background), 1);
    border-radius: 0 0 1.5rem 1.5rem;
  }

  .disclosure {
    background-color: rgba(var(--floating-color), 1);
    border: 3px solid rgba(var(--floating-color), 1);
    border-radius: 1.75rem;
    box-shadow: 0 1px 4px rgba(var(--shadow-color));
    inline-size: 100%;
  }

  .disclosure[open] .chevron-down-icon {
    display: none;
  }

  .disclosure[open] .chevron-up-icon {
    display: inline-block;
  }

  .summary {
    align-items: center;
    background-color: rgba(var(--floating-color), 1);
    border: 3px solid rgba(var(--floating-color), 1);
    border-radius: 1.75rem;
    cursor: pointer;
    display: flex;
    flex-direction: row;
    gap: 1rem;
    list-style: none;
    min-inline-size: 100%;
    outline: 3px solid transparent;
    outline-offset: 0;
    padding: 1.5rem;
    text-align: left;
    transition: outline-color 0.25s ease, outline-offset 0.25s ease;
    width: 100%;
  }

  .summary:focus-visible {
    outline: 3px dashed rgba(var(--secondary-color), 1);
    outline-offset: 4px;
  }

  .summary:hover {
    outline-color: rgba(var(--primary-color), 1);
    outline-offset: 2px;
  }

  .summary::-webkit-details-marker {
    display: none;
  }
</style>
